---
name: subagent-driven-development
description: Use when executing tasks.md from spec-kit workflow - dispatches subagents for tasks with checkpoints and code review between phases, enabling fast iteration with quality gates
---

# Subagent-Driven Development

Execute tasks.md by dispatching subagents per task, with checkpoints and code review after each phase.

**Core principle:** Fresh subagent per task + phase checkpoints + phase reviews = high quality, fast iteration

## Overview

**Integration with spec-kit:**
- Executes tasks from `tasks.md` generated by spec-kit workflow
- Fresh subagent per task (no context pollution)
- Code review after each phase (catch issues early)
- Checkpoints after each phase (safety fallbacks)
- Tasks marked [x] complete immediately (resilient to interruptions)

**When to use:**
- Executing `tasks.md` from a spec-kit feature directory
- Tasks organized by phases (any number of phases based on feature complexity)
- Want continuous progress with quality gates and safety checkpoints

**When NOT to use:**
- No `tasks.md` exists yet (run spec-kit /tasks command first)
- Tasks need significant revision (update spec first)
- Highly experimental work (manual execution better)

## The Process

### 1. Initial Setup

**Before starting any tasks:**

1. **Read `tasks.md`** from spec-kit feature directory (e.g., `specs/101-feature-name/tasks.md`)
2. **Identify all phases** in the file (any sections starting with `## Phase`)
3. **Create TodoWrite** with all tasks from all phases for session tracking
4. **Check for uncommitted changes:**
   - Run `git status`
   - If uncommitted changes exist: Use gitpro skill with message "Pre-tasks baseline"
5. **Ready to execute** - Begin with first phase

### 2. Execute Phase

**For each phase in tasks.md (detected by `## Phase` headers):**

#### Execute Individual Tasks

For each task in the phase:

1. **Identify task type:**
   - **[P] marker**: Can run in parallel with other [P] tasks in same phase
   - **No [P] marker**: Must run sequentially

2. **Dispatch subagent(s):**

**For sequential tasks:**
```
Task tool (general-purpose):
  description: "Execute [TID]: [task name]"
  prompt: |
    You are executing task [TID] from tasks.md in [feature-directory].

    Task description: [full task description with file path]

    Your job:
    1. Read the task requirements carefully
    2. Implement exactly what the task specifies
    3. Verify implementation works
    4. Report back

    Work from: [directory]

    Report: What you implemented, files changed, test results (if applicable), any issues
```

**For parallel tasks (all [P] in same phase):**
Dispatch multiple subagents simultaneously, one per task.

3. **Mark task complete immediately:**
   - Edit `tasks.md`: Change `[ ]` to `[x]` for completed task
   - Mark complete in TodoWrite
   - This happens IMMEDIATELY after each task finishes

4. **Continue until phase complete**

#### Special Phase Validations

**If phase contains test creation tasks:**
After test tasks complete, verify:
- All tests exist
- All tests FAIL (proving they test real functionality)
- If any test passes before implementation: STOP and fix the test

**Note:** This validation applies to any phase labeled with "Tests" or "TDD", not a specific phase number.

### 3. Phase Completion: Review & Checkpoint

**After all tasks in a phase are complete:**

1. **Dispatch code-reviewer:**
```
Skill: requesting-code-review
  Review scope: All work completed in [Phase Name]
  Context: Tasks [TID range] from tasks.md
```

2. **Apply review feedback:**
   - Fix Critical issues immediately
   - Fix Important issues before next phase
   - Note Minor issues for later phases

3. **Checkpoint with gitpro:**
```
Skill: gitpro checkpoint with message "[Phase Name]"
Result: "[Phase Name] - [timestamp]"
```

**Examples:**
- `"Phase 3.1: Setup - 2025-10-30_14:23.45"`
- `"Phase 1: Foundation - 2025-10-30_14:23.45"`
- `"Phase 4: Testing & Validation - 2025-10-30_14:23.45"`

4. **Mark phase complete** - Move to next phase

### 4. Continue Through All Phases

Repeat Step 2-3 for each phase found in tasks.md until all phases complete.

### 5. Implementation Complete

After final phase checkpoint:
- All tasks marked [x] in tasks.md
- All phases checkpointed
- All phase reviews passed
- Human takes over for final review and merge

## Example Workflow

```
You: I'm using Subagent-Driven Development to execute tasks.md

[Read specs/101-user-auth/tasks.md]
[Create TodoWrite with all tasks T001-T023]
[Check git status - uncommitted changes found]
[Use gitpro checkpoint "Pre-tasks baseline"]

=== Phase 3.1: Setup ===

Task T001: Create project structure per implementation plan
[Dispatch subagent]
Subagent: Created src/, tests/, config/ directories
[Mark T001 [x] in tasks.md + TodoWrite complete]

Task T002: Initialize TypeScript project with dependencies
[Dispatch subagent]
Subagent: Installed express, drizzle, clerk packages
[Mark T002 [x] in tasks.md + TodoWrite complete]

Task T003 [P]: Configure linting and formatting tools
[Dispatch subagent]
Subagent: Added biome config, updated package.json
[Mark T003 [x] in tasks.md + TodoWrite complete]

[All Phase 3.1 tasks complete]
[Use requesting-code-review skill: Review Phase 3.1 work]
Reviewer: Strengths: Clean structure. Issues: None
[Use gitpro checkpoint "Phase 3.1: Setup"]
Result: "Phase 3.1: Setup - 2025-10-30_14:23.45"

=== Phase 3.2: Tests First (TDD) ===

Tasks T004-T007 [P]: All contract and integration tests
[Dispatch 4 parallel subagents]
Subagent 1: POST /api/users contract test created
Subagent 2: GET /api/users/{id} contract test created
Subagent 3: User registration integration test created
Subagent 4: Auth flow integration test created
[Mark T004-T007 [x] in tasks.md + TodoWrite complete]

[Test Validation Gate: Verify all tests FAIL]
âœ“ All 4 tests fail as expected - ready for implementation

[Use requesting-code-review skill: Review Phase 3.2 work]
Reviewer: Strengths: Comprehensive coverage. Issues (Minor): Add timeout assertions
[Dispatch fix subagent to add timeout assertions]
[Use gitpro checkpoint "Phase 3.2: Tests First (TDD)"]
Result: "Phase 3.2: Tests First (TDD) - 2025-10-30_14:45.12"

=== Phase 3.3: Core Implementation ===

Task T008-T010 [P]: User model, UserService, CLI command
[Dispatch 3 parallel subagents]
[Mark T008-T010 [x] in tasks.md + TodoWrite complete]

Task T011: POST /api/users endpoint
[Dispatch subagent]
[Mark T011 [x] in tasks.md + TodoWrite complete]

... [Continue through T014]

[Use requesting-code-review skill: Review Phase 3.3 work]
Reviewer: Strengths: Tests passing. Issues (Important): Missing error boundaries
[Dispatch fix subagent for error boundaries]
[Use gitpro checkpoint "Phase 3.3: Core Implementation"]
Result: "Phase 3.3: Core Implementation - 2025-10-30_15:30.28"

... [Continue through Phases 3.4 and 3.5]

=== All Phases Complete ===

All tasks [x] marked complete in tasks.md
All phases checkpointed:
  - Phase 3.1: Setup - 2025-10-30_14:23.45
  - Phase 3.2: Tests First (TDD) - 2025-10-30_14:45.12
  - Phase 3.3: Core Implementation - 2025-10-30_15:30.28
  - Phase 3.4: Integration - 2025-10-30_16:15.03
  - Phase 3.5: Polish - 2025-10-30_16:45.22

Implementation complete! Ready for human review and merge.
```

## Advantages

**Spec-kit integration:**
- Works directly with tasks.md generated by spec-kit workflow
- Phase-based organization matches natural development flow
- [P] markers enable efficient parallel execution

**Quality gates:**
- Code review after each phase catches issues early
- Critical gate for Phase 3.2 ensures tests fail before implementation (true TDD)
- Checkpoint after each phase provides safety fallbacks

**Resilience:**
- Tasks marked [x] immediately prevents loss of progress
- Can resume from any point after interruption
- TodoWrite + tasks.md dual tracking ensures no confusion

**Efficiency:**
- Fresh subagent per task (no context pollution)
- Parallel execution where safe ([P] markers)
- Same session (no context switching overhead)

## Red Flags

**Never:**
- Skip code review after any phase
- Proceed to next phase with unfixed Critical issues
- Skip checkpoint after phase (lose safety fallback)
- Forget to mark tasks [x] immediately (lose progress tracking)
- Skip test validation gate if phase contains test creation (tests must fail before implementation)

**If subagent fails task:**
- Dispatch fix subagent with specific instructions
- Don't try to fix manually (fresh context is better)

**If interrupted mid-phase:**
- tasks.md shows exactly which tasks are [x] complete
- Resume from first unchecked task in that phase
- Continue phase, then review + checkpoint as normal

## Integration

**Required from spec-kit:**
- **tasks.md** - Generated by spec-kit `/tasks` command from feature specs
- Located in: `specs/[###-feature-name]/tasks.md`
- Contains: Phases, task IDs, [P] markers, file paths

**Required skills:**
- **gitpro** - Checkpoints after each phase (with custom messages)
- **requesting-code-review** - Code review after each phase
- Uses global `code-reviewer` agent (no prefix)

**Related spec-kit commands:**
- `/specify` - Creates feature specification
- `/plan` - Creates implementation plan
- `/tasks` - Generates tasks.md (prerequisite for this skill)

**Task format in tasks.md:**
```
- [ ] T001 Create project structure per implementation plan
- [ ] T002 [P] Initialize TypeScript project with dependencies
```

After execution:
```
- [x] T001 Create project structure per implementation plan
- [x] T002 [P] Initialize TypeScript project with dependencies
```
