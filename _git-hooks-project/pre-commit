#!/bin/bash
# Pre-commit hook: GitPro enforcement blocker
#
# All git commits should go through the GitPro skill which:
# 1. Validates TypeScript (via Claude Code PreToolUse hook)
# 2. Validates TODO tracking (via Claude Code PreToolUse hook)
# 3. Handles beads sync (in scripts)
# 4. Uses --no-verify to bypass this hook (since validation already passed)
#
# This hook blocks direct git commits and directs users to GitPro.
#
# BYPASS OPTIONS (emergency only):
#   SKIP_GIT_GUARD=1 git commit ...  # Emergency bypass

# Check for emergency bypass
if [ "$SKIP_GIT_GUARD" = "1" ]; then
    echo "âš ï¸  SKIP_GIT_GUARD: Bypassing GitPro enforcement"
    exit 0
fi

# Block direct commits
echo ""
echo "ğŸš« DIRECT GIT COMMIT BLOCKED"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Use the GitPro skill for all git operations:"
echo ""
echo "  â€¢ \"checkpoint\" - Quick timestamped commit"
echo "  â€¢ \"commit\"     - Full conventional commit with changelog"
echo "  â€¢ \"merge\"      - Merge to main with version bump"
echo ""
echo "GitPro ensures:"
echo "  âœ“ TypeScript validation (zero tolerance)"
echo "  âœ“ TODO tracking validation"
echo "  âœ“ Conventional commit format with emojis"
echo "  âœ“ Automatic changelog updates"
echo "  âœ“ Beads sync"
echo ""
echo "Emergency bypass: SKIP_GIT_GUARD=1 git commit ..."
echo ""
exit 1
